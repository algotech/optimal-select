"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.shortenSelectorByShifting = shortenSelectorByShifting;

/**
* Tries to shorten the selector if possible, starting from left
* @param {String} initialSelector The generated selector to be improved
* @param {Object} root            Document root where to search for element
* @param {JQuery} $element        The element to find a shorter selector for
*/
function shortenSelectorByShifting(initialSelector, root, $element) {
  var shorterSelector = initialSelector.split(' ');
  var lastShifted = '';

  while (isSelectorValid(shorterSelector.join(' ')) && $(root).find(shorterSelector.join(' ')).is($element) && $(root).find(shorterSelector.join(' ')).length == 1) {
    lastShifted = shorterSelector.shift();

    if (['>', '+', '~'].includes(shorterSelector[0])) {
      lastShifted += ' ' + shorterSelector.shift();
    }
  }

  var improvedSelector = "".concat(lastShifted, " ").concat(shorterSelector.join(' '));
  return improvedSelector.length < initialSelector.length ? improvedSelector : null;
}
/**
* Checks if the selector is syntactically valid
* @param selector The selector to be checked
*/


function isSelectorValid(selector) {
  try {
    document.createDocumentFragment().querySelector(selector);
  } catch (e) {
    return false;
  }

  return true;
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlbGVjdG9yLWdlbmVyYXRpb24vcHJvZHVjZS1zZWxlY3Rvci9wb3N0LWdlbmVyYXRpb24tb3B0aW1pemF0aW9uLmpzIl0sIm5hbWVzIjpbInNob3J0ZW5TZWxlY3RvckJ5U2hpZnRpbmciLCJpbml0aWFsU2VsZWN0b3IiLCJyb290IiwiJGVsZW1lbnQiLCJzaG9ydGVyU2VsZWN0b3IiLCJzcGxpdCIsImxhc3RTaGlmdGVkIiwiaXNTZWxlY3RvclZhbGlkIiwiam9pbiIsIiQiLCJmaW5kIiwiaXMiLCJsZW5ndGgiLCJzaGlmdCIsImluY2x1ZGVzIiwiaW1wcm92ZWRTZWxlY3RvciIsInNlbGVjdG9yIiwiZG9jdW1lbnQiLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwicXVlcnlTZWxlY3RvciIsImUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7Ozs7O0FBTU8sU0FBU0EseUJBQVQsQ0FBbUNDLGVBQW5DLEVBQW9EQyxJQUFwRCxFQUEwREMsUUFBMUQsRUFBb0U7QUFDekUsTUFBSUMsZUFBZSxHQUFHSCxlQUFlLENBQUNJLEtBQWhCLENBQXNCLEdBQXRCLENBQXRCO0FBQ0EsTUFBSUMsV0FBVyxHQUFHLEVBQWxCOztBQUVBLFNBQ0VDLGVBQWUsQ0FBQ0gsZUFBZSxDQUFDSSxJQUFoQixDQUFxQixHQUFyQixDQUFELENBQWYsSUFDQUMsQ0FBQyxDQUFDUCxJQUFELENBQUQsQ0FBUVEsSUFBUixDQUFhTixlQUFlLENBQUNJLElBQWhCLENBQXFCLEdBQXJCLENBQWIsRUFBd0NHLEVBQXhDLENBQTJDUixRQUEzQyxDQURBLElBRUFNLENBQUMsQ0FBQ1AsSUFBRCxDQUFELENBQVFRLElBQVIsQ0FBYU4sZUFBZSxDQUFDSSxJQUFoQixDQUFxQixHQUFyQixDQUFiLEVBQXdDSSxNQUF4QyxJQUFrRCxDQUhwRCxFQUlFO0FBQ0FOLElBQUFBLFdBQVcsR0FBR0YsZUFBZSxDQUFDUyxLQUFoQixFQUFkOztBQUNBLFFBQUksQ0FBQyxHQUFELEVBQU0sR0FBTixFQUFXLEdBQVgsRUFBZ0JDLFFBQWhCLENBQXlCVixlQUFlLENBQUMsQ0FBRCxDQUF4QyxDQUFKLEVBQWtEO0FBQ2hERSxNQUFBQSxXQUFXLElBQUksTUFBTUYsZUFBZSxDQUFDUyxLQUFoQixFQUFyQjtBQUNEO0FBQ0Y7O0FBQ0QsTUFBTUUsZ0JBQWdCLGFBQU1ULFdBQU4sY0FBcUJGLGVBQWUsQ0FBQ0ksSUFBaEIsQ0FBcUIsR0FBckIsQ0FBckIsQ0FBdEI7QUFFQSxTQUFPTyxnQkFBZ0IsQ0FBQ0gsTUFBakIsR0FBMEJYLGVBQWUsQ0FBQ1csTUFBMUMsR0FDTEcsZ0JBREssR0FFTCxJQUZGO0FBR0Q7QUFFRDs7Ozs7O0FBSUEsU0FBU1IsZUFBVCxDQUF5QlMsUUFBekIsRUFBbUM7QUFDakMsTUFBSTtBQUNGQyxJQUFBQSxRQUFRLENBQUNDLHNCQUFULEdBQWtDQyxhQUFsQyxDQUFnREgsUUFBaEQ7QUFDRCxHQUZELENBRUUsT0FBT0ksQ0FBUCxFQUFVO0FBQ1YsV0FBTyxLQUFQO0FBQ0Q7O0FBRUQsU0FBTyxJQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiogVHJpZXMgdG8gc2hvcnRlbiB0aGUgc2VsZWN0b3IgaWYgcG9zc2libGUsIHN0YXJ0aW5nIGZyb20gbGVmdFxuKiBAcGFyYW0ge1N0cmluZ30gaW5pdGlhbFNlbGVjdG9yIFRoZSBnZW5lcmF0ZWQgc2VsZWN0b3IgdG8gYmUgaW1wcm92ZWRcbiogQHBhcmFtIHtPYmplY3R9IHJvb3QgICAgICAgICAgICBEb2N1bWVudCByb290IHdoZXJlIHRvIHNlYXJjaCBmb3IgZWxlbWVudFxuKiBAcGFyYW0ge0pRdWVyeX0gJGVsZW1lbnQgICAgICAgIFRoZSBlbGVtZW50IHRvIGZpbmQgYSBzaG9ydGVyIHNlbGVjdG9yIGZvclxuKi9cbmV4cG9ydCBmdW5jdGlvbiBzaG9ydGVuU2VsZWN0b3JCeVNoaWZ0aW5nKGluaXRpYWxTZWxlY3Rvciwgcm9vdCwgJGVsZW1lbnQpIHtcbiAgbGV0IHNob3J0ZXJTZWxlY3RvciA9IGluaXRpYWxTZWxlY3Rvci5zcGxpdCgnICcpO1xuICBsZXQgbGFzdFNoaWZ0ZWQgPSAnJztcblxuICB3aGlsZSAoXG4gICAgaXNTZWxlY3RvclZhbGlkKHNob3J0ZXJTZWxlY3Rvci5qb2luKCcgJykpICYmXG4gICAgJChyb290KS5maW5kKHNob3J0ZXJTZWxlY3Rvci5qb2luKCcgJykpLmlzKCRlbGVtZW50KSAmJlxuICAgICQocm9vdCkuZmluZChzaG9ydGVyU2VsZWN0b3Iuam9pbignICcpKS5sZW5ndGggPT0gMVxuICApIHtcbiAgICBsYXN0U2hpZnRlZCA9IHNob3J0ZXJTZWxlY3Rvci5zaGlmdCgpO1xuICAgIGlmIChbJz4nLCAnKycsICd+J10uaW5jbHVkZXMoc2hvcnRlclNlbGVjdG9yWzBdKSkge1xuICAgICAgbGFzdFNoaWZ0ZWQgKz0gJyAnICsgc2hvcnRlclNlbGVjdG9yLnNoaWZ0KCk7XG4gICAgfVxuICB9XG4gIGNvbnN0IGltcHJvdmVkU2VsZWN0b3IgPSBgJHtsYXN0U2hpZnRlZH0gJHtzaG9ydGVyU2VsZWN0b3Iuam9pbignICcpfWA7XG5cbiAgcmV0dXJuIGltcHJvdmVkU2VsZWN0b3IubGVuZ3RoIDwgaW5pdGlhbFNlbGVjdG9yLmxlbmd0aCA/XG4gICAgaW1wcm92ZWRTZWxlY3RvciA6XG4gICAgbnVsbDtcbn1cblxuLyoqXG4qIENoZWNrcyBpZiB0aGUgc2VsZWN0b3IgaXMgc3ludGFjdGljYWxseSB2YWxpZFxuKiBAcGFyYW0gc2VsZWN0b3IgVGhlIHNlbGVjdG9yIHRvIGJlIGNoZWNrZWRcbiovXG5mdW5jdGlvbiBpc1NlbGVjdG9yVmFsaWQoc2VsZWN0b3IpIHtcbiAgdHJ5IHtcbiAgICBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cbiJdLCJmaWxlIjoic2VsZWN0b3ItZ2VuZXJhdGlvbi9wcm9kdWNlLXNlbGVjdG9yL3Bvc3QtZ2VuZXJhdGlvbi1vcHRpbWl6YXRpb24uanMifQ==
