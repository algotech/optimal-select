"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.configToOptions = void 0;

var _relevanceHelper = require("./relevance-helper");

var _this = void 0;

/**
 * Transforms aSelectorConfig into optimal-select options
 * @param {SelectorConfig} selectorConfig
 * @return {Object}
 */
var configToOptions = function configToOptions(selectorConfig) {
  return {
    root: document,
    // define order of attribute processing
    priority: ['id', 'class'],
    // specify which attributes to ignore
    ignore: {
      id: ignoreIdFn.bind(_this, selectorConfig),
      "class": ignoreClassFn.bind(_this, selectorConfig),
      tag: ignoreTagFn.bind(_this, selectorConfig),
      attribute: ignoreAttributeFn.bind(_this, selectorConfig)
    },
    exclude: {
      classname: 'no func'
    }
  };
};
/**
 * Decides if ids should be used in selector generation
 * @param {SelectorConfig} selectorConfig
 * @param {string} a
 * @param {string} idName
 * @return {boolean}
 */


exports.configToOptions = configToOptions;

function ignoreIdFn(selectorConfig, a, idName) {
  if (selectorConfig.isAllowIds()) {
    if ((0, _relevanceHelper.isSelectorRandomlyGenerated)(idName) && selectorConfig.isExcludingRandomSelectors()) {
      return true;
    }

    var forbiddenSubstrings = selectorConfig.getForbiddenIdSubstrings();

    for (var i = 0; i < forbiddenSubstrings.length; i++) {
      if (idName.includes(forbiddenSubstrings[i])) {
        return true; // ignore id name with forbidden substring
      }
    }

    return false; // allow all ids that reached this point
  }

  return true; // ignore all ids
}
/**
 * Decides if classes should be used in selector generation
 * @param {SelectorConfig} selectorConfig
 * @param {string} a
 * @param {string} className
 * @return {boolean}
 */


function ignoreClassFn(selectorConfig, a, className) {
  if (className && selectorConfig.isAllowClasses()) {
    if (className.length > 30) {
      return true; // ignore long classes
    } // if (isSelectorRandomlyGenerated(className) && selectorConfig.isExcludingRandomSelectors()) {
    //   return true;
    // }
    // const forbiddenSubstrings = selectorConfig.getForbiddenClassSubstrings();
    // for (let i = 0; i < forbiddenSubstrings.length; i++) {
    //   if (className.includes(forbiddenSubstrings[i])) {
    //     return true; // ignore class name with forbidden substring
    //   }
    // }


    return false; // don't ignore classes who reached until here
  }

  return true; // ignore all classes
}
/**
 * Decides if tags should be used in selector generation
 * @param {SelectorConfig} selectorConfig
 * @param {string} a
 * @param {string} tagName
 * @return {boolean}
 */


function ignoreTagFn(selectorConfig, a, tagName) {
  if (selectorConfig.isAllowTags()) {
    return false; // allow all tags
  }

  return true; // ignore all tags
}
/**
 * Decides if attributes should be used in selector generation
 * @param {SelectorConfig} selectorConfig
 * @param {string} attributeName
 * @param {string} attributeValue
 * @param {Function} defaultPredicate
 * @return {boolean}
 */


function ignoreAttributeFn(selectorConfig, attributeName, attributeValue, defaultPredicate) {
  if (selectorConfig.isAllowAttributes()) {
    if (((0, _relevanceHelper.isSelectorRandomlyGenerated)(attributeName) || (0, _relevanceHelper.isSelectorRandomlyGenerated)(attributeValue)) && selectorConfig.isExcludingRandomSelectors()) {
      return true;
    }

    var forbiddenSubstrings = selectorConfig.getForbiddenAttributeSubstrings();

    for (var i = 0; i < forbiddenSubstrings.length; i++) {
      if (attributeName.includes(forbiddenSubstrings[i])) {
        return true;
      }
    } // allow default attributes


    return defaultPredicate(attributeName, attributeValue);
  }

  return true; // ignore all attributes
}

function excludeClassFn(selectorConfig, className) {
  // if (className.length > 30) {
  //   return true; // ignore long classes
  // }
  if ((0, _relevanceHelper.isSelectorRandomlyGenerated)(className) && selectorConfig.isExcludingRandomSelectors()) {
    return true;
  }

  var forbiddenSubstrings = selectorConfig.getForbiddenClassSubstrings();

  for (var i = 0; i < forbiddenSubstrings.length; i++) {
    if (className.includes(forbiddenSubstrings[i])) {
      return true; // ignore class name with forbidden substring
    }
  }

  return false; // don't exclude classes who reached until here
}

var _default = {
  configToOptions: configToOptions
};
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlbGVjdG9yLWdlbmVyYXRpb24vcHJvZHVjZS1zZWxlY3Rvci9vcHRpb25zLWNvbnZlcnRlci5qcyJdLCJuYW1lcyI6WyJjb25maWdUb09wdGlvbnMiLCJzZWxlY3RvckNvbmZpZyIsInJvb3QiLCJkb2N1bWVudCIsInByaW9yaXR5IiwiaWdub3JlIiwiaWQiLCJpZ25vcmVJZEZuIiwiYmluZCIsImlnbm9yZUNsYXNzRm4iLCJ0YWciLCJpZ25vcmVUYWdGbiIsImF0dHJpYnV0ZSIsImlnbm9yZUF0dHJpYnV0ZUZuIiwiZXhjbHVkZSIsImNsYXNzbmFtZSIsImEiLCJpZE5hbWUiLCJpc0FsbG93SWRzIiwiaXNFeGNsdWRpbmdSYW5kb21TZWxlY3RvcnMiLCJmb3JiaWRkZW5TdWJzdHJpbmdzIiwiZ2V0Rm9yYmlkZGVuSWRTdWJzdHJpbmdzIiwiaSIsImxlbmd0aCIsImluY2x1ZGVzIiwiY2xhc3NOYW1lIiwiaXNBbGxvd0NsYXNzZXMiLCJ0YWdOYW1lIiwiaXNBbGxvd1RhZ3MiLCJhdHRyaWJ1dGVOYW1lIiwiYXR0cmlidXRlVmFsdWUiLCJkZWZhdWx0UHJlZGljYXRlIiwiaXNBbGxvd0F0dHJpYnV0ZXMiLCJnZXRGb3JiaWRkZW5BdHRyaWJ1dGVTdWJzdHJpbmdzIiwiZXhjbHVkZUNsYXNzRm4iLCJnZXRGb3JiaWRkZW5DbGFzc1N1YnN0cmluZ3MiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7OztBQUVBOzs7OztBQUtPLElBQU1BLGVBQWUsR0FBRyxTQUFsQkEsZUFBa0IsQ0FBQUMsY0FBYztBQUFBLFNBQUs7QUFDaERDLElBQUFBLElBQUksRUFBRUMsUUFEMEM7QUFFaEQ7QUFDQUMsSUFBQUEsUUFBUSxFQUFFLENBQUMsSUFBRCxFQUFPLE9BQVAsQ0FIc0M7QUFJaEQ7QUFDQUMsSUFBQUEsTUFBTSxFQUFFO0FBQ05DLE1BQUFBLEVBQUUsRUFBRUMsVUFBVSxDQUFDQyxJQUFYLENBQWdCLEtBQWhCLEVBQXNCUCxjQUF0QixDQURFO0FBRU4sZUFBT1Es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Q0YsYUFBRCxFQUFnQkMsY0FBaEIsQ0FBdkI7QUFDRDs7QUFFRCxTQUFPLElBQVAsQ0F0QkEsQ0FzQmE7QUFDZDs7QUFFRCxTQUFTSSxjQUFULENBQXdCakMsY0FBeEIsRUFBd0N3QixTQUF4QyxFQUFtRDtBQUMvQztBQUNBO0FBQ0E7QUFDRixNQUFJLGtEQUE0QkEsU0FBNUIsS0FBMEN4QixjQUFjLENBQUNrQiwwQkFBZixFQUE5QyxFQUEyRjtBQUN6RixXQUFPLElBQVA7QUFDRDs7QUFDRCxNQUFNQyxtQkFBbUIsR0FBR25CLGNBQWMsQ0FBQ2tDLDJCQUFmLEVBQTVCOztBQUVBLE9BQUssSUFBSWIsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR0YsbUJBQW1CLENBQUNHLE1BQXhDLEVBQWdERCxDQUFDLEVBQWpELEVBQXFEO0FBQ25ELFFBQUlHLFNBQVMsQ0FBQ0QsUUFBVixDQUFtQkosbUJBQW1CLENBQUNFLENBQUQsQ0FBdEMsQ0FBSixFQUFnRDtBQUM5QyxhQUFPLElBQVAsQ0FEOEMsQ0FDakM7QUFDZDtBQUNGOztBQUVELFNBQU8sS0FBUCxDQWZpRCxDQWVuQztBQUNmOztlQUVjO0FBQ2J0QixFQUFBQSxlQUFlLEVBQWZBO0FBRGEsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzU2VsZWN0b3JSYW5kb21seUdlbmVyYXRlZCB9IGZyb20gJy4vcmVsZXZhbmNlLWhlbHBlcic7XG5cbi8qKlxuICogVHJhbnNmb3JtcyBhU2VsZWN0b3JDb25maWcgaW50byBvcHRpbWFsLXNlbGVjdCBvcHRpb25zXG4gKiBAcGFyYW0ge1NlbGVjdG9yQ29uZmlnfSBzZWxlY3RvckNvbmZpZ1xuICogQHJldHVybiB7T2JqZWN0fVxuICovXG5leHBvcnQgY29uc3QgY29uZmlnVG9PcHRpb25zID0gc2VsZWN0b3JDb25maWcgPT4gKHtcbiAgcm9vdDogZG9jdW1lbnQsXG4gIC8vIGRlZmluZSBvcmRlciBvZiBhdHRyaWJ1dGUgcHJvY2Vzc2luZ1xuICBwcmlvcml0eTogWydpZCcsICdjbGFzcyddLFxuICAvLyBzcGVjaWZ5IHdoaWNoIGF0dHJpYnV0ZXMgdG8gaWdub3JlXG4gIGlnbm9yZToge1xuICAgIGlkOiBpZ25vcmVJZEZuLmJpbmQodGhpcywgc2VsZWN0b3JDb25maWcpLFxuICAgIGNsYXNzOiBpZ25vcmVDbGFzc0ZuLmJpbmQodGhpcywgc2VsZWN0b3JDb25maWcpLFxuICAgIHRhZzogaWdub3JlVGFnRm4uYmluZCh0aGlzLCBzZWxlY3RvckNvbmZpZyksXG4gICAgYXR0cmlidXRlOiBpZ25vcmVBdHRyaWJ1dGVGbi5iaW5kKHRoaXMsIHNlbGVjdG9yQ29uZmlnKSxcbiAgfSxcbiAgZXhjbHVkZToge1xuICAgIGNsYXNzbmFtZTogJ25vIGZ1bmMnLFxuICB9XG59KTtcblxuLyoqXG4gKiBEZWNpZGVzIGlmIGlkcyBzaG91bGQgYmUgdXNlZCBpbiBzZWxlY3RvciBnZW5lcmF0aW9uXG4gKiBAcGFyYW0ge1NlbGVjdG9yQ29uZmlnfSBzZWxlY3RvckNvbmZpZ1xuICogQHBhcmFtIHtzdHJpbmd9IGFcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZE5hbWVcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlnbm9yZUlkRm4oc2VsZWN0b3JDb25maWcsIGEsIGlkTmFtZSkge1xuICBpZiAoc2VsZWN0b3JDb25maWcuaXNBbGxvd0lkcygpKSB7XG4gICAgaWYgKGlzU2VsZWN0b3JSYW5kb21seUdlbmVyYXRlZChpZE5hbWUpICYmIHNlbGVjdG9yQ29uZmlnLmlzRXhjbHVkaW5nUmFuZG9tU2VsZWN0b3JzKCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBjb25zdCBmb3JiaWRkZW5TdWJzdHJpbmdzID0gc2VsZWN0b3JDb25maWcuZ2V0Rm9yYmlkZGVuSWRTdWJzdHJpbmdzKCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZvcmJpZGRlblN1YnN0cmluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChpZE5hbWUuaW5jbHVkZXMoZm9yYmlkZGVuU3Vic3RyaW5nc1tpXSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIGlnbm9yZSBpZCBuYW1lIHdpdGggZm9yYmlkZGVuIHN1YnN0cmluZ1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTsgLy8gYWxsb3cgYWxsIGlkcyB0aGF0IHJlYWNoZWQgdGhpcyBwb2ludFxuICB9XG5cbiAgcmV0dXJuIHRydWU7IC8vIGlnbm9yZSBhbGwgaWRzXG59XG5cbi8qKlxuICogRGVjaWRlcyBpZiBjbGFzc2VzIHNob3VsZCBiZSB1c2VkIGluIHNlbGVjdG9yIGdlbmVyYXRpb25cbiAqIEBwYXJhbSB7U2VsZWN0b3JDb25maWd9IHNlbGVjdG9yQ29uZmlnXG4gKiBAcGFyYW0ge3N0cmluZ30gYVxuICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzTmFtZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaWdub3JlQ2xhc3NGbihzZWxlY3RvckNvbmZpZywgYSwgY2xhc3NOYW1lKSB7XG4gIGlmIChjbGFzc05hbWUgJiYgc2VsZWN0b3JDb25maWcuaXNBbGxvd0NsYXNzZXMoKSkge1xuICAgIGlmIChjbGFzc05hbWUubGVuZ3RoID4gMzApIHtcbiAgICAgIHJldHVybiB0cnVlOyAvLyBpZ25vcmUgbG9uZyBjbGFzc2VzXG4gICAgfVxuICAgIC8vIGlmIChpc1NlbGVjdG9yUmFuZG9tbHlHZW5lcmF0ZWQoY2xhc3NOYW1lKSAmJiBzZWxlY3RvckNvbmZpZy5pc0V4Y2x1ZGluZ1JhbmRvbVNlbGVjdG9ycygpKSB7XG4gICAgLy8gICByZXR1cm4gdHJ1ZTtcbiAgICAvLyB9XG4gICAgLy8gY29uc3QgZm9yYmlkZGVuU3Vic3RyaW5ncyA9IHNlbGVjdG9yQ29uZmlnLmdldEZvcmJpZGRlbkNsYXNzU3Vic3RyaW5ncygpO1xuXG4gICAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCBmb3JiaWRkZW5TdWJzdHJpbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gICBpZiAoY2xhc3NOYW1lLmluY2x1ZGVzKGZvcmJpZGRlblN1YnN0cmluZ3NbaV0pKSB7XG4gICAgLy8gICAgIHJldHVybiB0cnVlOyAvLyBpZ25vcmUgY2xhc3MgbmFtZSB3aXRoIGZvcmJpZGRlbiBzdWJzdHJpbmdcbiAgICAvLyAgIH1cbiAgICAvLyB9XG5cbiAgICByZXR1cm4gZmFsc2U7IC8vIGRvbid0IGlnbm9yZSBjbGFzc2VzIHdobyByZWFjaGVkIHVudGlsIGhlcmVcbiAgfVxuXG4gIHJldHVybiB0cnVlOyAvLyBpZ25vcmUgYWxsIGNsYXNzZXNcbn1cblxuLyoqXG4gKiBEZWNpZGVzIGlmIHRhZ3Mgc2hvdWxkIGJlIHVzZWQgaW4gc2VsZWN0b3IgZ2VuZXJhdGlvblxuICogQHBhcmFtIHtTZWxlY3RvckNvbmZpZ30gc2VsZWN0b3JDb25maWdcbiAqIEBwYXJhbSB7c3RyaW5nfSBhXG4gKiBAcGFyYW0ge3N0cmluZ30gdGFnTmFtZVxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaWdub3JlVGFnRm4oc2VsZWN0b3JDb25maWcsIGEsIHRhZ05hbWUpIHtcbiAgaWYgKHNlbGVjdG9yQ29uZmlnLmlzQWxsb3dUYWdzKCkpIHtcbiAgICByZXR1cm4gZmFsc2U7IC8vIGFsbG93IGFsbCB0YWdzXG4gIH1cblxuICByZXR1cm4gdHJ1ZTsgLy8gaWdub3JlIGFsbCB0YWdzXG59XG5cbi8qKlxuICogRGVjaWRlcyBpZiBhdHRyaWJ1dGVzIHNob3VsZCBiZSB1c2VkIGluIHNlbGVjdG9yIGdlbmVyYXRpb25cbiAqIEBwYXJhbSB7U2VsZWN0b3JDb25maWd9IHNlbGVjdG9yQ29uZmlnXG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0cmlidXRlTmFtZVxuICogQHBhcmFtIHtzdHJpbmd9IGF0dHJpYnV0ZVZhbHVlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBkZWZhdWx0UHJlZGljYXRlXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpZ25vcmVBdHRyaWJ1dGVGbihcbiAgc2VsZWN0b3JDb25maWcsXG4gIGF0dHJpYnV0ZU5hbWUsXG4gIGF0dHJpYnV0ZVZhbHVlLFxuICBkZWZhdWx0UHJlZGljYXRlXG4pIHtcbiAgaWYgKHNlbGVjdG9yQ29uZmlnLmlzQWxsb3dBdHRyaWJ1dGVzKCkpIHtcbiAgICBpZiAoKFxuICAgICAgICBpc1NlbGVjdG9yUmFuZG9tbHlHZW5lcmF0ZWQoYXR0cmlidXRlTmFtZSkgfHxcbiAgICAgICAgaXNTZWxlY3RvclJhbmRvbWx5R2VuZXJhdGVkKGF0dHJpYnV0ZVZhbHVlKVxuICAgICAgKSAmJlxuICAgICAgc2VsZWN0b3JDb25maWcuaXNFeGNsdWRpbmdSYW5kb21TZWxlY3RvcnMoKVxuICAgICkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGNvbnN0IGZvcmJpZGRlblN1YnN0cmluZ3MgPSBzZWxlY3RvckNvbmZpZy5nZXRGb3JiaWRkZW5BdHRyaWJ1dGVTdWJzdHJpbmdzKCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZvcmJpZGRlblN1YnN0cmluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChhdHRyaWJ1dGVOYW1lLmluY2x1ZGVzKGZvcmJpZGRlblN1YnN0cmluZ3NbaV0pKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGFsbG93IGRlZmF1bHQgYXR0cmlidXRlc1xuICAgIHJldHVybiBkZWZhdWx0UHJlZGljYXRlKGF0dHJpYnV0ZU5hbWUsIGF0dHJpYnV0ZVZhbHVlKTtcbiAgfVxuXG4gIHJldHVybiB0cnVlOyAvLyBpZ25vcmUgYWxsIGF0dHJpYnV0ZXNcbn1cblxuZnVuY3Rpb24gZXhjbHVkZUNsYXNzRm4oc2VsZWN0b3JDb25maWcsIGNsYXNzTmFtZSkge1xuICAgIC8vIGlmIChjbGFzc05hbWUubGVuZ3RoID4gMzApIHtcbiAgICAvLyAgIHJldHVybiB0cnVlOyAvLyBpZ25vcmUgbG9uZyBjbGFzc2VzXG4gICAgLy8gfVxuICBpZiAoaXNTZWxlY3RvclJhbmRvbWx5R2VuZXJhdGVkKGNsYXNzTmFtZSkgJiYgc2VsZWN0b3JDb25maWcuaXNFeGNsdWRpbmdSYW5kb21TZWxlY3RvcnMoKSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGNvbnN0IGZvcmJpZGRlblN1YnN0cmluZ3MgPSBzZWxlY3RvckNvbmZpZy5nZXRGb3JiaWRkZW5DbGFzc1N1YnN0cmluZ3MoKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGZvcmJpZGRlblN1YnN0cmluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoY2xhc3NOYW1lLmluY2x1ZGVzKGZvcmJpZGRlblN1YnN0cmluZ3NbaV0pKSB7XG4gICAgICByZXR1cm4gdHJ1ZTsgLy8gaWdub3JlIGNsYXNzIG5hbWUgd2l0aCBmb3JiaWRkZW4gc3Vic3RyaW5nXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZhbHNlOyAvLyBkb24ndCBleGNsdWRlIGNsYXNzZXMgd2hvIHJlYWNoZWQgdW50aWwgaGVyZVxufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIGNvbmZpZ1RvT3B0aW9uc1xufTtcbiJdLCJmaWxlIjoic2VsZWN0b3ItZ2VuZXJhdGlvbi9wcm9kdWNlLXNlbGVjdG9yL29wdGlvbnMtY29udmVydGVyLmpzIn0=
